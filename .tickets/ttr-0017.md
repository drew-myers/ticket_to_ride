---
id: ttr-0017
status: closed
deps: [ttr-0001]
links: []
created: 2026-01-29T22:30:00Z
type: chore
priority: 3
assignee: acmyers
parent:
tags: [testing]
external-ref: gh-23
---
# Backfill Tests

Add comprehensive test coverage once the API stabilizes.

## Description

Current test coverage is focused on pure functions and edge cases we've encountered. Once the codebase is more stable, backfill tests for:

### Unit Tests
- Config validation edge cases (invalid TOML, missing required fields)
- More ticket parsing edge cases
- Error handling paths

### Integration Tests (with mocking)
- Consider adding trait abstraction for `GitHubClient` to enable mocking
- Test sync logic with mocked API responses
- Test batch operations error handling

### Potential Approaches
1. **Trait-based mocking** - Define `trait GitHubApi` and have real/mock impls
2. **`mockall` crate** - Auto-generate mocks from traits
3. **Record/replay** - Capture real API responses for replay in tests

## Current Coverage

| Module | Tests | Notes |
|--------|-------|-------|
| config | 4 | Good |
| ticket | 12 | Good - includes edge cases |
| auth | 1 | Minimal |
| github/client | 2 | Minimal |
| github/issues | 1 | Minimal |
| sync | 5 | Good for pure functions |

## Acceptance Criteria

- [ ] Decide on mocking strategy
- [ ] Add trait abstraction if going that route
- [ ] Test error handling paths in sync logic
- [ ] Test batch operation partial failures
- [ ] Achieve >80% line coverage on core modules
