---
id: ttr-0014
status: closed
deps: [ttr-0001]
links: []
created: 2026-01-29T18:13:00Z
type: task
priority: 2
assignee: acmyers
parent: ttr-0012
tags: [github, subissues]
external-ref: gh-19
---
# Sub-Issue Relationship Sync

Implement syncing ticket parent/child relationships as GitHub sub-issues.

## Description

Implement in `src/github/subissues.rs`:

### Sub-Issue Creation
- `add_sub_issue(parent_issue_id, child_issue_id)`
- Uses the `addSubIssue` GraphQL mutation

### Sync Logic

During push, after creating/updating issues:

1. For each ticket with a `parent` field:
   - Check if parent ticket has `external-ref: gh-{N}`
   - Check if child ticket has `external-ref: gh-{M}`
   - If both synced, call `addSubIssue(parent_issue, child_issue)`

2. Handle already-linked case:
   - `addSubIssue` might return error if already linked
   - Treat this as success (idempotent)

### Ordering Consideration

Parent tickets should be synced before children so parent has external-ref when child is processed.

Options:
1. Sort tickets by parent relationship (topological sort)
2. Two-pass: create all issues first, then link relationships
3. Lazy linking: skip if parent not synced yet, link on next push

Recommend option 2 (two-pass) for simplicity.

## Acceptance Criteria

- [ ] Parent/child tickets are linked as sub-issues in GitHub
- [ ] Handles case where parent not yet synced (skip with note)
- [ ] Idempotent - running twice doesn't error on already-linked
- [ ] Works with nested hierarchies (grandparent → parent → child)
