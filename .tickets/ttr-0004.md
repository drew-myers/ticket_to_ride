---
id: ttr-0004
status: open
deps: [ttr-0002]
links: []
created: 2026-01-29T18:03:00Z
type: task
priority: 1
assignee: acmyers
parent: ttr-0001
tags: [parser]
external-ref: gh-4
---
# Ticket Parsing

Implement parsing of ticket markdown files from `.tickets/` directory.

## Description

Parse ticket files with YAML frontmatter. Each ticket is a markdown file like:

```yaml
---
id: nw-5c46
status: open
deps: [dep-1234]
links: []
created: 2026-01-29T12:00:00Z
type: task
priority: 2
assignee: John Doe
external-ref: gh-123
parent: parent-id
tags: [ui, backend]
---
# Ticket Title

Description...

## Design

Design notes...

## Acceptance Criteria

- Criterion 1
```

Implement in `src/ticket.rs`:
- `Ticket` struct with all frontmatter fields
- `Ticket::parse(path)` to parse a single ticket file
- `Ticket::load_all(tickets_dir)` to load all tickets
- `Ticket::write_external_ref()` to update the external-ref field
- Extract title from first `# ` heading
- Extract body sections (description, design, acceptance criteria)
- Handle optional fields gracefully

Use `gray_matter` crate for frontmatter extraction.

## Acceptance Criteria

- [ ] Parses all frontmatter fields correctly
- [ ] Extracts title from markdown heading
- [ ] Extracts body content (excluding Notes section)
- [ ] Handles missing optional fields
- [ ] Can write external-ref back to file without corrupting other content
- [ ] Loads all .md files from tickets directory
